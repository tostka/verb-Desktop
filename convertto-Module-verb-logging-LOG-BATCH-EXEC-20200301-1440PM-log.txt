2020-03-01 14:40:11 INFO: #*======v START PASS:convertto-Module.ps1 v======
2020-03-01 14:40:11 INFO: 14:40:11:$ModuleName interpolated from verb-Desktop.ps1: verb-Desktop
2020-03-01 14:40:11 INFO: 14:40:11:$ModuleDesc specified: Powershell Desktop generic functions module
2020-03-01 14:40:17 INFO: Invoke-Plaster w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
TemplatePath                   C:\sc\powershell\FullModuleTemplate\                                                                                                
DestinationPath                C:\sc\verb-Desktop                                                                                                                  
ModuleName                     verb-Desktop                                                                                                                        
ModuleDesc                     Powershell Desktop generic functions module
2020-03-01 14:40:17 INFO: 
**IN THE PROMPTS BELOW, USE THE FOLLOWING!**:
Github Repo Name For This Module:	verb-Desktop
Github Repo Url For This Module:	https://github.com/tostka/verb-Desktop

2020-03-01 14:41:52 INFO: Opening a copy of $oModSrcFile:
C:\usr\work\exch\scripts\verb-Desktop.ps1
for reference
2020-03-01 14:41:53 INFO: Opening a copy of $psmFile:
(C:\sc\verb-Desktop\verb-Desktop\verb-Desktop.psm1.fullname)
for EDITING
2020-03-01 14:44:44 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Out-Excel.ps1                                                                                             
whatif                         False
2020-03-01 14:44:59 INFO: Pre-populating the Out-Excel.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:45:23 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Out-Excel-Events.ps1                                                                                      
whatif                         False
2020-03-01 14:45:29 INFO: Pre-populating the Out-Excel-Events.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:45:51 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\start-ItunesPlaylist.ps1                                                                                  
whatif                         False
2020-03-01 14:46:18 INFO: Pre-populating the start-ItunesPlaylist.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:27 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Speak-words.ps1                                                                                           
whatif                         False
2020-03-01 14:46:34 INFO: Pre-populating the Speak-words.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:34 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Go.ps1                                                                                                    
whatif                         False
2020-03-01 14:46:34 INFO: Pre-populating the Go.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:34 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Define-MoveWindow.ps1                                                                                     
whatif                         False
2020-03-01 14:46:35 INFO: Pre-populating the Define-MoveWindow.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:35 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Move-Window.ps1                                                                                           
whatif                         False
2020-03-01 14:46:35 INFO: Pre-populating the Move-Window.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:35 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Move-WindowByWindowTitle.ps1                                                                              
whatif                         False
2020-03-01 14:46:35 INFO: Pre-populating the Move-WindowByWindowTitle.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:35 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\gotoIncid.ps1                                                                                             
whatif                         False
2020-03-01 14:46:35 INFO: Pre-populating the gotoIncid.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:35 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\~.ps1                                                                                                     
whatif                         False
2020-03-01 14:46:35 INFO: Pre-populating the ~.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:35 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\...ps1                                                                                                    
whatif                         False
2020-03-01 14:46:35 INFO: Pre-populating the ...ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\....ps1                                                                                                   
whatif                         False
2020-03-01 14:46:36 INFO: Pre-populating the ....ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\.....ps1                                                                                                  
whatif                         False
2020-03-01 14:46:36 INFO: Pre-populating the .....ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\gotoDownloads.ps1                                                                                         
whatif                         False
2020-03-01 14:46:36 INFO: Pre-populating the gotoDownloads.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\gotoDbox.ps1                                                                                              
whatif                         False
2020-03-01 14:46:36 INFO: Pre-populating the gotoDbox.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\gotoDboxDb.ps1                                                                                            
whatif                         False
2020-03-01 14:46:36 INFO: Pre-populating the gotoDboxDb.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\openInput.ps1                                                                                             
whatif                         False
2020-03-01 14:46:36 INFO: Pre-populating the openInput.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\openTmpps1.ps1                                                                                            
whatif                         False
2020-03-01 14:46:36 INFO: Pre-populating the openTmpps1.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Set.ps1                                                                                                   
whatif                         False
2020-03-01 14:46:36 INFO: Pre-populating the Set.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:36 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Clean-Desktop.ps1                                                                                         
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the Clean-Desktop.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\New-GitHubGist.ps1                                                                                        
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the New-GitHubGist.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Get-FsoShortName.ps1                                                                                      
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the Get-FsoShortName.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Get-FsoTypeObj.ps1                                                                                        
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the Get-FsoTypeObj.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Compare-ObjectsSideBySide.ps1                                                                             
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the Compare-ObjectsSideBySide.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Compare-ObjectsSideBySide3.ps1                                                                            
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the Compare-ObjectsSideBySide3.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Compare-ObjectsSideBySide4.ps1                                                                            
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the Compare-ObjectsSideBySide4.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\Report-URL.ps1                                                                                            
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the Report-URL.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\show-TrayTip.ps1                                                                                          
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the show-TrayTip.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: new-item w
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
path                           C:\sc\verb-Desktop\Public\c-winsallk.ps1                                                                                            
whatif                         False
2020-03-01 14:46:37 INFO: Pre-populating the c-winsallk.ps1 with the function body
(may *not* include associated aliases!)
2020-03-01 14:46:37 INFO: Parsing function list out of C:\usr\work\exch\scripts\verb-Desktop.ps1
use these with FunctionsToExport 'func1', 'func2' at bottom of the .psm1 file
2020-03-01 14:46:38 INFO: Updating manifest .psd1 FunctionsToExport to reflect all functions above:
(C:\sc\verb-Desktop\verb-Desktop\verb-Desktop.psd1)
2020-03-01 14:47:04 INFO: Copying module guid to the $TestScriptPath:C:\sc\verb-Desktop\Tests\verb-Desktop.tests.ps1
2020-03-01 14:47:17 INFO: Opening a copy of the Manifest (.psd1) file:
C:\sc\verb-Desktop\verb-Desktop\verb-Desktop.psd1
for EDITING
2020-03-01 14:47:32 INFO: BuildVariables for C:\usr\work\exch\scripts\verb-Desktop.ps1:
$-----------
Name                           Value                                                                                                                               
----                           -----                                                                                                                               
BHProjectName                  verb-AAD                                                                                                                            
BHModulePath                   C:\sc\verb-AAD\verb-AAD                                                                                                             
BHPSModulePath                 C:\sc\verb-AAD\verb-AAD                                                                                                             
BHProjectPath                  C:\sc\verb-AAD                                                                                                                      
BHBuildOutput                  C:\sc\verb-AAD\BuildOutput                                                                                                          
BHPSModuleManifest             C:\sc\verb-AAD\verb-AAD\verb-AAD.psd1                                                                                               
BHBuildSystem                  Unknown                                                                                                                             
BHCommitMessage                aa10724201e207b2527df2ed4cc8c41654440353                                                                                            
BHBranchName                   master                                                                                                                              
BHBuildNumber                  0
$-----------

2020-03-01 14:47:40 INFO: Test-ModuleManifest results for :
$-----------
((verb-AAD |out-string).trim())
$-----------

2020-03-01 14:50:43 INFO: 
#*------v FOLLOW-ON PROCEDURE v------

1) **Edit the following portion of the verb-Desktop.psd1 file:**

     - Populate FunctionsToExport,
    Functions parsed from the C:\usr\work\exch\scripts\verb-Desktop.ps1 include:
    

    - Psd1 version is: 1.0.8
    Set ModuleVersion in 'n.n.n' format, or you'll see ...
    Publish-PSArtifactUtility : Failed to publish module 'verb-transcript': 'File does not exist
    ... .nupkg file errors
    - Make sure the psm1 CBH Version: n.n.n tag is updated to match (optional)

2) **Copy the public/exported functions from the source .ps1/psm1 into the the matching new function-named files in the Public folder
  & Internal folders (for non-exported functions)

3) Edit the readme.md file.
    notepad2.exe C:\sc\verb-Desktop\README.md

4) Edit the .psm1 file
    notepad2.exe C:\sc\verb-Desktop\verb-Desktop\verb-Desktop.psm1

5) Optional all-in-one that encapsulates remaining steps below: (RUN AS SID, REQ'S PERMS TO REPO & ADMIN PROFILE)

# To do a monolithic merged .psm1, sign, and publish to specified Repo,
.\process-NewModule.ps1 -ModuleName "verb-Desktop" -ModDirPath "C:\sc\verb-Desktop" -Repository "lyncRepo" -Merge -showdebug -whatif ;

==Following are the component pieces of the encapsulating process-NewModule.ps1 processing above:

6) Optionally Merge the default Dyanamic-Include version of the .psm1, to a Monolithic .psm1 (faster loading):
    .\merge-Module.ps1 -ModuleName verb-Desktop -ModuleSourcePath "C:\sc\verb-Desktop\Public","C:\sc\verb-Desktop\Internal" -ModuleDestinationPath C:\sc\verb-Desktop\verb-Desktop -showdebug -whatif ;

7) Sign relevenent files:
$rgxfiles='\.(CAT|MSI|JAR,OCX|PS1|PSM1|PSD1|PS1XML|PSC1|MSP|CMD|BAT|VBS)$' ;
$rgxIncludeDirs='\\(Public|Internal|Classes)\\' ;
$files = gci C:\sc\verb-Desktop\* -recur |?{$_.extension -match $rgxfiles} | ?{$_.fullname -notmatch $rgxIncludeDirs} ;
sign-file -file $files.fullname ;

8) Clear any existing copy in $PSProfilePath: (use SID at work w lyncRepo!)
    remove-item -Recurse -Path C:\Users\kadrits\Documents\WindowsPowerShell\Modules\verb-Desktop\*.* -whatif ;

9) Then copy the module to the $PSProfilePath: (excluding .git & .vscode subfolders ; use SID at work w lyncRepo!

$from='C:\sc\verb-Desktop' ; $to = 'C:\Users\kadrits\Documents\WindowsPowerShell\Modules\verb-Desktop' ;
 $exclude = @('main.js') ; $excludeMatch = @('.git','.vscode') ;
[regex] $excludeMatchRegEx = '(?i)' + (($excludeMatch |foreach {[regex]::escape($_)}) -join "|") + '' ;
Get-ChildItem -Path $from -Recurse -Exclude $exclude |
where { $excludeMatch -eq $null -or $_.FullName.Replace($from, '') -notmatch $excludeMatchRegEx} |
Copy-Item -Destination {  if ($_.PSIsContainer) { Join-Path $to $_.Parent.FullName.Substring($from.length) }
else { Join-Path $to $_.FullName.Substring($from.length) }    } -Force -Exclude $exclude -whatif ;



10) Validate module function (should be visible in the results)
    Get-Module -ListAvailable -Name verb-Desktop

11) Exit and restart PS to fully register module (though listed by Get-Module, can see
    'Publish-Module : ...no module with that name was found in any module directory.'
    ... errors, until post-restart.epository lyncRepo -Verbose -whatif


12)	Publish to the Repo: Verify the repo is present & publish:
    Get-PSRepository ;

    Publish-Module -Name verb-Desktop -Repository lyncRepo -Verbose -whatif
    # or from source dir
    Publish-Module -Name C:\sc\verb-Desktop -R

13) Confirm publication: list all the modules in your repo, (or search)
    Find-Module -Name verb-Desktop ;

14) Installing mods from the repo:

    Pre-clear all files in local non-installed version in $PSProfilePath: (isn't manageable, use SID at work w lyncRepo!)
    gci -Recurse -Path "C:\Users\kadrits\Documents\WindowsPowerShell\Modules\verb-Desktop\*.*" |?{ ! $_.PSIsContainer } | remove-item -whatif ;

    Install the Repo version:
    Install-Module -Name verb-Desktop -Repository lyncRepo -scope CurrentUser -AllowClobber -force -whatif ;

===========
TO FIND & UPDATE DEPENDANT FILES THAT CURRENTLY LEVERAGE verb-Desktop.ps1, RUN:

gci C:\sc\powershell\*.ps1 -recur | sort name| ss '\$tModFile\s=\s"verb-Desktop\.ps1"'


For each matching .ps1:
a) Rem/remove any load block like the above
b) Above params, at script start, add a suitable #Requires for this updated installed module:
		#Requires -Modules verb-Desktop
    (can be on separate lines, or comma-delimited list of like items).
    Other Requres directives that may be suitable with this change: (## => Rem'd conflicting variant)
        ##Requires –Version 2.0
        #Requires –Version 3
        #requires -PSEdition Desktop
        ##requires -PSEdition Core
        #Requires –PSSnapin Microsoft.Exchange.Management.PowerShell.E2010
        #Requires -Modules ActiveDirectory,  Azure,  AzureAD,  AzureRM,  GroupPolicy,  Lync,  Microsoft.Online.SharePoint.PowerShell,  MSOnline,  ScheduledTasks,  SkypeOnlineConnector
        #Requires -RunasAdministrator

===========
TO BRING UPDATED REPO/MODULE ONTO ANOTHER MACHINE

    a) Clone in the repo from GitHub:

    cd C:\sc\ ;
    # & Git clone [gh repo https clone url]
    Git clone https://github.com/tostka/verb-Desktop.git --porcelain ;


    b) Add Repo to GitHubDesktop

    c) Run steps 7-13 above, to install into local repo, and install Module locally onto machine(s) from published Repo

===========
TO DO FUTURE REVISION UPDATES:

    a) Profile & increment current Psd1 version: -By (Build|Major|Minor|Patch)
    cd C:\sc\verb-Desktop ; 
    import-module buildhelpers ; Set-BuildEnvironment ;
    Step-ModuleVersion -Path C:\sc\verb-AAD\verb-AAD\verb-AAD.psd1 -By build
    
    ==Optionally, all-in-one, Merge & Uninstall/Repub/Reinstall/Test-import script:
    .\process-NewModule.ps1 -ModuleName "verb-Desktop" -ModDirPath "C:\sc\verb-Desktop" -Repository lyncRepo  -Merge -showdebug -whatif ;

    ==Or do one piece at a time:
    b) Uninstall the existing version (avoids update-module's habit of
        leaving out of date content in place.)

        Uninstall-Module -Name verb-Desktop -AllVersions -force -whatif ;

    c) Copy the updated module to the PSProfilePath:

$from='C:\sc\verb-Desktop' ; $to = 'C:\Users\kadrits\Documents\WindowsPowerShell\Modules\verb-Desktop' ;
$exclude = @('main.js') ; $excludeMatch = @('.git','.vscode') ;
[regex] $excludeMatchRegEx = '(?i)' + (($excludeMatch |foreach {[regex]::escape($_)}) -join "|") + '' ;
Get-ChildItem -Path $from -Recurse -Exclude $exclude |
where { $excludeMatch -eq $null -or $_.FullName.Replace($from, '') -notmatch $excludeMatchRegEx} |
Copy-Item -Destination {  if ($_.PSIsContainer) { Join-Path $to $_.Parent.FullName.Substring($from.length) }
else { Join-Path $to $_.FullName.Substring($from.length) }    } -Force -Exclude $exclude -whatif ;


    d) Republish the updated module:

    Publish-Module -Name verb-Desktop -Repository lyncRepo -Verbose -whatif

    e) Reinstall from the Repo

    Install-Module -Name verb-Desktop -Repository lyncRepo -whatif ;


#*------^ END FOLLOW-ON PROCEDURE  ^------


